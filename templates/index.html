<!doctype html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Εκκρεμότητες</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <nav class="navbar">
    <a href="{{ url_for('index') }}" class="navbar-link is-active">Εκκρεμότητες</a>
    <a href="{{ url_for('duties') }}" class="navbar-link">Υπηρεσίες</a>
    <a href="{{ url_for('staff') }}" class="navbar-link">Στελέχη</a>
  </nav>
  <div class="page-container">
    <form method="get" class="filter-form">
      <label for="order_by" class="label-strong">Ταξινόμηση κατά:</label>
      <select name="order_by" id="order_by" class="select-control" onchange="this.form.submit()">
        <option value="name" {% if order_by == 'name' %}selected{% endif %}>Όνομα</option>
        <option value="rank" {% if order_by == 'rank' %}selected{% endif %}>Βαθμό</option>
        <option value="pending" {% if order_by == 'pending' %}selected{% endif %}>Εκκρεμείς</option>
        <option value="received" {% if order_by == 'received' %}selected{% endif %}>Ληφθείσες</option>
      </select>
    </form>

    <div class="table-panel">
      <h2 class="section-heading">Εκκρεμότητες Στελεχών</h2>
      <div class="table-wrapper">
        <table class="data-table">
          <thead>
            <tr>
              <th>Βαθμός</th>
              <th>Όνομα</th>
              <th class="is-centered">Εκκρεμείς Απαλλαγές</th>
              <th class="is-centered">Ληφθείσες απαλλαγές</th>
            </tr>
          </thead>
          <tbody>
            {% for s in staff %}
              {% set pending = pending_days_off[s.id] %}
              {% set received = received_days_off[s.id] %}
              <tr class="table-row {% if pending > 0 %}is-warning{% else %}is-success{% endif %}">
                <td>{{ s.rank }}</td>
                <td>
                  <a href="{{ url_for('staff_duties', staff_id=s.id) }}" class="link-highlight">
                    {{ s.name }}
                  </a>
                </td>
                <td class="is-centered">
                  <span class="badge warning">{{ pending }}</span>
                </td>
                <td class="is-centered">
                  <span class="badge success">{{ received }}</span>
                </td>
              </tr>
            {% else %}
              <tr>
                <td colspan="4" class="is-centered empty-state">
                  Κανένα στέλεχος με εκκρεμότητα.
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

</body>
</html>
